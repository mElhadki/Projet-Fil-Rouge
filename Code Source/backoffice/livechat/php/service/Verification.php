<?php
class Verification extends Service { private $config; public function onRegister() { parent::onRegister(); $this->config = $this->get('config'); } public function verifyInstallation() { $sp01dbf2 = $this->config->data['services']['verify']; $spee5166 = $sp01dbf2['code']; $spa59a90 = $sp01dbf2['token']; return $this->verifyCodeToken($spee5166, $spa59a90); } public function verifyCodeToken($spee5166, $spa59a90) { if (is_array($spee5166)) { return !empty($spee5166[0]) && !empty($spee5166[1]) && !empty($spa59a90) && sha1(md5($spee5166[0] . $spee5166[1])) == $spa59a90; } return !empty($spee5166) && !empty($spa59a90) && sha1(md5($spee5166)) == $spa59a90; } public function updateInstallation($spee5166, $spa59a90) { $this->config->updateParameters(array('services' => array('verify' => array('code' => $spee5166, 'token' => $spa59a90)))); } }